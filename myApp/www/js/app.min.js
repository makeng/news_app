!function(){angular.module("myApp",["ionic","news","newsDetail","weather","setting","newsDetailSer","citySer"]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$ionicConfigProvider",function(t,e,a,n){n.platform.ios.tabs.style("standard"),n.platform.ios.tabs.position("bottom"),n.platform.android.tabs.style("standard"),n.platform.android.tabs.position("standard"),n.platform.ios.navBar.alignTitle("center"),n.platform.android.navBar.alignTitle("left"),n.platform.ios.backButton.previousTitleText("").icon("ion-ios-arrow-thin-left"),n.platform.android.backButton.previousTitleText("").icon("ion-android-arrow-back"),n.platform.ios.views.transition("ios"),n.platform.android.views.transition("android"),e.otherwise("/default"),t.state("tab1",{url:"/tab1",views:{view1:{controller:"newsCtrl",templateUrl:"pages/news/news.html"}}}).state("newsDetail",{url:"/newsDetail/:id",views:{view1:{controller:"newsDetailCtrl",templateUrl:"pages/news/newsDetail.html"}}}).state("tab2",{url:"/tab2",views:{view2:{controller:"weatherCtrl",templateUrl:"pages/weather/weather.html"}}}).state("tab3",{url:"/tab3",views:{view3:{controller:"settingCtrl",templateUrl:"pages/setting/setting.html"}}}),a.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded"}]).controller("indexCon",[function(){}]).constant("local",!1).constant("version","1.0.0").service("Cookie",[function(){this.set=function(t,e,a){var n=new Date;n.setDate(n.getDate()+a),document.cookie=t+"="+encodeURIComponent(e)+";expires="+n},this.get=function(t){for(var e=document.cookie.replace(/ /g,""),a=e.split(";"),n=0;n<a.length;n++){var i=a[n].split("=");if(i[0]==t)return decodeURIComponent(i[1])}return null},this.remove=function(t){var e=new Date;document.cookie=t+"=;expires="+e}}])}(),function(){angular.module("news",[]).controller("newsCtrl",["$rootScope","$scope","$http","$timeout","NewsCh","NewsDetail",function(t,e,a,n,i,s){function o(){u.getData(function(t,a){e.channel=a[0],e.newsChannelArrFront4=a.slice(0,4),e.newsChannelArrAfter4=a.slice(4),t>=5?e.isMoreCh=!0:e.isMoreCh=!1})}var c=function(){this.page=1,this.data=[];var t=this;this.getData=function(e,n){var i="http://route.showapi.com/109-35",o="55f74716416141b1ac2d81797a321538",c=function(){var t=new Date;return t.getFullYear()+""+(t.getMonth()+1)+(t.getDate()<10?"0"+t.getDate():t.getDate())+(t.getHours()<10?"0"+t.getHours():t.getHours())+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}();a.get(i,{params:{showapi_appid:"28034",showapi_timestamp:c,showapi_sign:o,needAllList:0,needHtml:0,maxResult:20,channelName:e,page:t.page}}).success(function(e){console.log(e);var a=e.showapi_res_body.pagebean.contentlist;t.data==[]?t.data=a:t.data=t.data.concat(a),n&&n(t.data),s.setData(t.data)})},this.clearData=function(){this.data=[]}},r=function(){this.data=[],this.cnt=0;var t=this;this.getData=function(e){var a=i.get();t.data=[],t.cnt=0,angular.forEach(a,function(e,a){1==e.chk&&(t.data.push(e),t.cnt++)}),e&&e(t.cnt,t.data),console.log(this.data)}},l=new c,u=new r;e.hideMoreNews=!0,e.selected=[!0,!1,!1,!1,!1],o(),i.receiveUpdateBroadcast(function(){o()}),e.newsRefreshData=function(){l.page=1,l.clearData(),l.getData(e.channel.name,function(t){e.newsList=t}),e.$broadcast("scroll.refreshComplete")},e.newsGetData=function(){n(function(){l.getData(e.channel.name,function(t){e.newsList=t}),l.page++,e.$broadcast("scroll.infiniteScrollComplete")},500)},e.selTab=function(t){e.channel=u.data[t],l.clearData(),e.newsList=[],l.getData(e.channel.name,function(t){e.newsList=t}),e.$broadcast("scroll.infiniteScrollComplete"),e.selected=[],e.selected[t]=!0,t<4&&(e.hideMoreNews=!0)},e.showMoreNewsTitle=function(){e.hideMoreNews=!e.hideMoreNews}}])}(),function(){angular.module("newsDetail",[]).controller("newsDetailCtrl",["$scope","$stateParams","NewsDetail",function(t,e,a){t.txt=a.getData()[e.id]}])}(),function(){angular.module("newsDetailSer",[]).service("NewsDetail",[function(){this.data=[],this.getData=function(){return this.data},this.setData=function(t){this.data=t}}]).service("NewsCh",["$rootScope","Cookie",function(t,e){this.data=[];var a=this.data,n=this;this.isSet=!1,this.cnt=0,this.set=function(t){a=t,e.set("NewsCh",JSON.stringify(a),30)},this.updateBroadcast=function(){n.isSet=!0,t.$broadcast("to-news",n.isSet)},this.receiveUpdateBroadcast=function(e){n.isSet=!1,t.$on("to-news",function(t,a){e&&e()})},this.get=function(){return a=e.get("NewsCh"),a=JSON.parse(a),a!=[]&&void 0!=a||(a=[{name:"国内最新",chk:!0,num:1},{name:"国际最新",chk:!0,num:2},{name:"国内焦点",chk:!0,num:3},{name:"国际焦点",chk:!0,num:4},{name:"社会最新",chk:!0,num:5},{name:"社会焦点",chk:!0,num:6},{name:"军事最新",chk:!0,num:7},{name:"军事焦点",chk:!0,num:8},{name:"互联网最新",chk:!1,num:9},{name:"体育最新",chk:!1,num:10},{name:"体育焦点",chk:!1,num:11},{name:"娱乐最新",chk:!1,num:12},{name:"娱乐焦点",chk:!1,num:13},{name:"科技最新",chk:!1,num:14},{name:"科技焦点",chk:!1,num:15}]),a},this.regroup=function(){for(var t=[],e=1,n=!0;e<=a.length;e++)angular.forEach(a,function(a,i){a.num==e&&(t.push(a),n=!1)});for(e=0;e<a.length;e++)t[e].num=e+1;return a=t}}])}(),function(){angular.module("setting",[]).controller("settingCtrl",["$scope","$http","$timeout","$ionicScrollDelegate","City","NewsCh",function(t,e,a,n,i,s){var o=function(){this.data=[],this.cnt=0,this.unCheckedData=[],this.checkedData=[],this.selectedData=[];var t=this;this.getData=function(){this.data=s.get()},this.getUncheckedData=function(){var t=[];angular.forEach(r.data,function(e,a){e.chk||t.push(e)}),this.unCheckedData=t},this.getCheckedData=function(){this.cnt=0;var e=[];angular.forEach(r.data,function(a,n){1==a.chk&&(t.cnt++,a.num=t.cnt,e.push(a))}),this.checkedData=e}},c=function(){this.data=[],this.allList=[];var t=this;this.getData=function(){this.data=i.get()},this.getAllList=function(a){var n="json/city.json";e.get(n).success(function(e){t.allList=e,a&&a(e)})}},r=new o;r.getData(),r.getCheckedData(),t.NewsCh=r.checkedData,t.NewsChDel=function(t){r.checkedData[t].chk=!1,r.selectedData=r.checkedData.splice(t,1),r.unCheckedData.push(r.selectedData[0]),s.set(r.checkedData.concat(r.unCheckedData)),s.updateBroadcast()},t.NewsChAdd=function(){t.showSelList=!0,t.aniSelList=!1,u=2,r.getUncheckedData();var e=[];angular.forEach(r.unCheckedData,function(t,a){e.push(t.name)}),t.list=e},t.list=[],t.showSelList=!1,t.aniSelList=!1;var l=new c;l.getData(),t.city=l.data;var u=0;t.selCity=function(){t.showSelList=!0,t.aniSelList=!1,t.list=[],u=0,l.getAllList(function(e){angular.forEach(e,function(e,a){t.list.push(e.province)})})},t.closeSelList=function(){u=0,t.showSelList=!1,t.aniSelList=!0},t.selItem=function(e){a(function(){switch(u){case 0:t.list=[],angular.forEach(l.allList[e].city,function(e,a){t.list.push(e.name)}),u=1,n.$getByHandle("small").scrollTop(!1);break;case 1:t.showSelList=!1,t.aniSelList=!0,t.city=t.list[e],i.set(t.city),i.broadcast(),u=0;break;case 2:var a=r.unCheckedData.splice(e,1);a[0].chk=!0,r.checkedData.push(a[0]),s.set(r.checkedData.concat(r.unCheckedData)),s.updateBroadcast(),t.showSelList=!1,t.aniSelList=!0}},500)}}])}(),function(){angular.module("weather",[]).controller("weatherCtrl",["$scope","$http","City",function(t,e,a){var n=function(){this.getWeatherClassName=function(t){var e="";switch(t){case"多云":e="ion-ios-partlysunny";break;case"晴":e="ion-ios-sunny";break;case"阴":e="ion-cloud";break;case"雾":e="ion-navicon";break;case"小雨":e="ion-waterdrop";break;case"大雨":e="ion-ios-rainy";break;case"雷阵雨":e="ion-ios-thunderstorm";break;case"冰雹":e="ion-record";break;case"冻雨":e="ion-ios-rainy-outline";break;case"雨夹雪":e="ion-ios-snowy";break;case"小雪":e="ion-ios-snowy";break;case"中雪":e="ion-ios-snowy";break;case"大雪":e="ion-ios-snowy";break;case"阵雪":e="ion-ios-snowy";break;case"霜冻":e="ion-ios-medical-outline";break;case"大风":e="ion-ios-rewind-outline";break;case"霾":e="ion-grid"}return e},this.getCity=function(){return a.get()},this.getWeatherData=function(t,a){var n="http://wthrcdn.etouch.cn/weather_mini?city="+t;e.get(n).success(function(t){var e=[];e.push(t.data.yesterday),e=e.concat(t.data.forecast);var n=[];angular.forEach(e,function(t,e){n.push(t.type)}),a&&a(e,n)})},this.receive=function(){a.receive(function(e){t.city=e,console.log(e)})}},i=new n;i.receive();var s=i.getCity();t.dateMark=[" (昨天)"," (今天)"," (明天)"],t.weatherClass=[],t.city=s,i.getWeatherData(s,function(e,a){t.list=e,angular.forEach(a,function(e,a){t.weatherClass.push(i.getWeatherClassName(e))})})}])}(),function(){angular.module("citySer",[]).service("City",["Cookie","$rootScope",function(t,e){this.data="",this.isSet=!1;var a=this;this.set=function(e){a.data=e,t.set("City",a.data,30)},this.get=function(){return a.data=t.get("City"),""!=a.data&&void 0!=a.data||(a.data="深圳"),a.data},this.broadcast=function(){e.$broadcast("to-city",a.data)},this.receive=function(t){e.$on("to-city",function(e,a){t&&t(a)})}}])}();